knitr::opts_chunk$set(echo = TRUE)
case <- read.csv('./Data/Case.csv')
summary(case)
case <- read.csv('./Data/Case.csv')
patientinfo <- read.csv('./Data/PatientInfo.csv')
policy <- read.csv('./Data/Policy.csv')
region <- read.csv('./Data/Region.csv')
searchtrend <- read.csv('./Data/SearchTrend.csv')
seoulfloating <- read.csv('./Data/SeoulFloating.csv')
time <- read.csv('./Data/Time.csv')
timeage <- read.csv('./Data/TimeAge.csv')
timegender <- read.csv('./Data/TimeGender.csv')
timeprovince <- read.csv('./Data/TimeProvince.csv')
weather <- read.csv('./Data/Weather.csv')
library(tidyverse)
library(RColorBrewer)
library(ggplot2)
patientinfo %>%
filter(year(Date_Confirm) > 2019) %>%
group_by(Date_Confirm) %>%
summarise(x = n()) %>%
ggplot(., aes(Date_Confirm, x))+
geom_line(size = 1.6, alpha = 0.8, col = "gray65")+
geom_smooth(method = "loess", color = "firebrick3", size = 2.2, formula = y ~ x, fill = "firebrick4", alpha = 0.32)+
#geom_point(size = 2.3, alpha = 0.7, col = "gray10")+
scale_y_continuous(limits = c(0,150))+
labs(title = "Number of new infected people", subtitle = "by Date (n = 5165)",
y = "Number of infected", x = "")+
scale_x_date(date_labels = "%b %d", date_breaks = "32 days")+
theme_fivethirtyeight()+
theme(axis.title = element_text(size = 15.5, face = "bold"), axis.text = element_text(size = 15), plot.background = element_rect(fill = "#fff6ed"),
axis.line = element_line(size = 0.4, colour = "grey10"), plot.subtitle = element_text(size = 15),
panel.background = element_rect(fill = "white"))
install.packages("lubridate")
install.packages("lubridate")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(RColorBrewer)
library(lubridate)
library(ggplot2)
patientinfo %>%
filter(year(Date_Confirm) > 2019) %>%
group_by(Date_Confirm) %>%
summarise(x = n()) %>%
ggplot(., aes(Date_Confirm, x))+
geom_line(size = 1.6, alpha = 0.8, col = "gray65")+
geom_smooth(method = "loess", color = "firebrick3", size = 2.2, formula = y ~ x, fill = "firebrick4", alpha = 0.32)+
#geom_point(size = 2.3, alpha = 0.7, col = "gray10")+
scale_y_continuous(limits = c(0,150))+
labs(title = "Number of new infected people", subtitle = "by Date (n = 5165)",
y = "Number of infected", x = "")+
scale_x_date(date_labels = "%b %d", date_breaks = "32 days")+
theme_fivethirtyeight()+
theme(axis.title = element_text(size = 15.5, face = "bold"), axis.text = element_text(size = 15), plot.background = element_rect(fill = "#fff6ed"),
axis.line = element_line(size = 0.4, colour = "grey10"), plot.subtitle = element_text(size = 15),
panel.background = element_rect(fill = "white"))
patientinfo %>%
filter(year(patientinfo$confirmed_date) > 2019) %>%
group_by(patientinfo$confirmed_date) %>%
summarise(x = n()) %>%
ggplot(., aes(patientinfo$confirmed_date, x))+
geom_line(size = 1.6, alpha = 0.8, col = "gray65")+
geom_smooth(method = "loess", color = "firebrick3", size = 2.2, formula = y ~ x, fill = "firebrick4", alpha = 0.32)+
#geom_point(size = 2.3, alpha = 0.7, col = "gray10")+
scale_y_continuous(limits = c(0,150))+
labs(title = "Number of new infected people", subtitle = "by Date (n = 5165)",
y = "Number of infected", x = "")+
scale_x_date(date_labels = "%b %d", date_breaks = "32 days")+
theme_fivethirtyeight()+
theme(axis.title = element_text(size = 15.5, face = "bold"), axis.text = element_text(size = 15), plot.background = element_rect(fill = "#fff6ed"),
axis.line = element_line(size = 0.4, colour = "grey10"), plot.subtitle = element_text(size = 15),
panel.background = element_rect(fill = "white"))
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_rec <- as.Date(patientinfo$released_date)
patientinfo %>%
filter(year(patientinfo$Date_conf) > 2019) %>%
group_by(patientinfo$Date_conf) %>%
summarise(x = n()) %>%
ggplot(., aes(patientinfo$Date_conf, x))+
geom_line(size = 1.6, alpha = 0.8, col = "gray65")+
geom_smooth(method = "loess", color = "firebrick3", size = 2.2, formula = y ~ x, fill = "firebrick4", alpha = 0.32)+
#geom_point(size = 2.3, alpha = 0.7, col = "gray10")+
scale_y_continuous(limits = c(0,150))+
labs(title = "Number of new infected people", subtitle = "by Date (n = 5165)",
y = "Number of infected", x = "")+
scale_x_date(date_labels = "%b %d", date_breaks = "32 days")+
theme_fivethirtyeight()+
theme(axis.title = element_text(size = 15.5, face = "bold"), axis.text = element_text(size = 15), plot.background = element_rect(fill = "#fff6ed"),
axis.line = element_line(size = 0.4, colour = "grey10"), plot.subtitle = element_text(size = 15),
panel.background = element_rect(fill = "white"))
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_rec <- as.Date(patientinfo$released_date)
patientinfo <- patientinfo[,c(1,2,6,7,8,9,3,15,16,17)]
case <- read.csv('./Data/Case.csv')
patientinfo <- read.csv('./Data/PatientInfo.csv', stringsAsFactors = FALSE)
policy <- read.csv('./Data/Policy.csv')
region <- read.csv('./Data/Region.csv')
searchtrend <- read.csv('./Data/SearchTrend.csv')
seoulfloating <- read.csv('./Data/SeoulFloating.csv')
time <- read.csv('./Data/Time.csv')
timeage <- read.csv('./Data/TimeAge.csv')
timegender <- read.csv('./Data/TimeGender.csv')
timeprovince <- read.csv('./Data/TimeProvince.csv')
weather <- read.csv('./Data/Weather.csv')
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_rec <- as.Date(patientinfo$released_date)
patientinfo <- patientinfo[,c(1,2,6,7,8,9,3,15,16,17)]
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_rec <- as.Date(patientinfo$released_date)
patientinfo$DaysToRec <- as.Date(patientinfo$Date_rec - patientinfo$Date_conf)
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_rec <- as.Date(patientinfo$released_date)
patientinfo$DaysToRec <- as.numeric(patientinfo$Date_rec - patientinfo$Date_conf)
patientinfo <- patientinfo[,c(1,2,6,7,8,9,3,15,16,17)]
patientinfo %>%
filter(year(patientinfo$Date_conf) > 2019) %>%
group_by(patientinfo$Date_conf) %>%
summarise(x = n()) %>%
ggplot(., aes(patientinfo$Date_conf, x))+
geom_line(size = 1.6, alpha = 0.8, col = "gray65")+
geom_smooth(method = "loess", color = "firebrick3", size = 2.2, formula = y ~ x, fill = "firebrick4", alpha = 0.32)+
#geom_point(size = 2.3, alpha = 0.7, col = "gray10")+
scale_y_continuous(limits = c(0,150))+
labs(title = "Number of new infected people", subtitle = "by Date (n = 5165)",
y = "Number of infected", x = "")+
scale_x_date(date_labels = "%b %d", date_breaks = "32 days")+
theme_fivethirtyeight()+
theme(axis.title = element_text(size = 15.5, face = "bold"), axis.text = element_text(size = 15), plot.background = element_rect(fill = "#fff6ed"),
axis.line = element_line(size = 0.4, colour = "grey10"), plot.subtitle = element_text(size = 15),
panel.background = element_rect(fill = "white"))
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
library(tidyverse)
library(RColorBrewer)
library(lubridate)
library(ggplot2)
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
library(tidyverse)
library(RColorBrewer)
library(lubridate)
library(ggplot2)
patientinfo$Date_conf <- as.Date(patientinfo$confirmed_date)
patientinfo %>%
group_by(confirmed_date) %>%
summarise(n = n()) %>%
ggplot(aes(confirmed_date, n))+
geom_line(size = 2, alpha = 0.8, col="red")+
geom_point(size = 5, alpha = 1, col="blue")+
labs(title = "The number of Infected people in South Korea",
subtitle = paste0("Total infections: ", nrow(patient_2)),
caption = "Pink line means the trend") +
scale_x_date(date_labels = "%b %d", date_breaks = "2 days")+
theme_light() +
theme(plot.title = element_text(face = "bold",
hjust = 0.5, size = 18, color = "black"),
plot.subtitle = element_text(face = "bold",
size = 12, color = "blue")) +
ggrepel::geom_label_repel(aes(label=n), hjust=1.5, vjust=0.9,
fill ="skyblue") +
geom_smooth(method = "gam", se = TRUE, alpha = 0.5, col = "pink")
patient_2 <- patient %>%
mutate(age = 2020 - birth_year +1) %>%
mutate(age_range = cut(age,
breaks = seq(0, 100, 10),
right = FALSE,
labels = c("less_10","10~19","20~29","30~39","40~49",
"50~59","60~69","70~79","80~89","over_90"))) %>%
mutate(age_range = as.character(age_range)) %>%
mutate(days_for_recovery = (released_date - confirmed_date) %>% as.integer) %>%
mutate(days_for_dying = (deceased_date - confirmed_date) %>% as.integer) %>%
mutate(disease = ifelse(disease==1, "dis", disease)) %>%
mutate_if(is.character,  function(x) {ifelse(is.na(x),"Unk", x)}) %>%
mutate(region = str_replace_all(region, "filtered at airport","Filtered at airport")) %>%
mutate(region = str_replace_all(region, "capital area","Capital area")) %>%
mutate(region_group = paste0(region," + ", group)) %>%
filter(!is.na(confirmed_date))
case <- read.csv('./Data/Case.csv')
patient <- read.csv('./Data/PatientInfo.csv', stringsAsFactors = FALSE)
policy <- read.csv('./Data/Policy.csv')
region <- read.csv('./Data/Region.csv')
searchtrend <- read.csv('./Data/SearchTrend.csv')
seoulfloating <- read.csv('./Data/SeoulFloating.csv')
time <- read.csv('./Data/Time.csv')
timeage <- read.csv('./Data/TimeAge.csv')
timegender <- read.csv('./Data/TimeGender.csv')
timeprovince <- read.csv('./Data/TimeProvince.csv')
weather <- read.csv('./Data/Weather.csv')
patient_2 <- patient %>%
mutate(age = 2020 - birth_year +1) %>%
mutate(age_range = cut(age,
breaks = seq(0, 100, 10),
right = FALSE,
labels = c("less_10","10~19","20~29","30~39","40~49",
"50~59","60~69","70~79","80~89","over_90"))) %>%
mutate(age_range = as.character(age_range)) %>%
mutate(days_for_recovery = (released_date - confirmed_date) %>% as.integer) %>%
mutate(days_for_dying = (deceased_date - confirmed_date) %>% as.integer) %>%
mutate(disease = ifelse(disease==1, "dis", disease)) %>%
mutate_if(is.character,  function(x) {ifelse(is.na(x),"Unk", x)}) %>%
mutate(region = str_replace_all(region, "filtered at airport","Filtered at airport")) %>%
mutate(region = str_replace_all(region, "capital area","Capital area")) %>%
mutate(region_group = paste0(region," + ", group)) %>%
filter(!is.na(confirmed_date))
patient_2 <- patient %>%
mutate(days_for_recovery = (released_date - confirmed_date) %>% as.integer) %>%
mutate(days_for_dying = (deceased_date - confirmed_date) %>% as.integer) %>%
mutate(disease = ifelse(disease==1, "dis", disease)) %>%
mutate_if(is.character,  function(x) {ifelse(is.na(x),"Unk", x)}) %>%
mutate(region = str_replace_all(region, "filtered at airport","Filtered at airport")) %>%
mutate(region = str_replace_all(region, "capital area","Capital area")) %>%
mutate(region_group = paste0(region," + ", group)) %>%
filter(!is.na(confirmed_date))
install.packages("ggthemes")
allpat <- patient%>%group_by(province)%>%summarise(n=n())
allpat <- patient%>%group_by(province)%>%summarise(n=n())
allpat <- allpat[c(order(-allpat$n)),]
ggplot(allpat, aes(y=n, x=reorder(province,n), fill=province))+
geom_bar(stat="identity")+
coord_flip()+
ggtitle(label = "Patient Number in Each Province")
allpat <- patient%>%group_by(province)%>%summarise(n=n())
summary(allpat)
allpat <- allpat[c(order(-allpat$n)),]
ggplot(allpat, aes(y=n, x=reorder(province,n), fill=province))+
geom_bar(stat="identity")+
coord_flip()+
ggtitle(label = "Patient Number in Each Province")
allpat <- patient%>%group_by(province)%>%summarise(n=n())
allpat <- patient%>%group_by(province)%>%summarise(n=n())
allpat <- patient%>%group_by(province)%>%summarise(n=n())
# Group number of patients by province
byprovince <- patient%>%group_by(province)%>%summarise(n=n())
# Reorder by the number of patients in each province
byprovince <- byprovince[c(order(-byprovince$n)),]
ggplot(byprovince, aes(y=n, x=reorder(byprovince,n), fill=province))+
geom_bar(stat="identity")+
coord_flip()+
ggtitle(label = "Patient Number in Each Province")
# Group number of patients by province
byprovince <- patient%>%group_by(province)%>%summarise(n=n())
# Reorder by the number of patients in each province
byprovince <- byprovince[c(order(-byprovince$n)),]
ggplot(byprovince, aes(y=n, x=reorder(province,n), fill=province))+
geom_bar(stat="identity")+
coord_flip()+
ggtitle(label = "Patient Number in Each Province")
# Group number of patients by province
byprovince <- patient%>%group_by(province)%>%summarise(n=n())
# Reorder by the number of patients in each province
byprovince <- byprovince[c(order(-byprovince$n)),]
ggplot(byprovince, aes(y=n, x=reorder(province,n), fill=province)) +
geom_bar(stat="identity") +
coord_flip() +
xlab("Patient Number") +
ylab("Province Name") +
ggtitle(label = "Patient Number in Each Province")
# Group number of patients by province
byprovince <- patient%>%group_by(province)%>%summarise(n=n())
# Reorder by the number of patients in each province
byprovince <- byprovince[c(order(-byprovince$n)),]
ggplot(byprovince, aes(y=n, x=reorder(province,n), fill=province)) +
geom_bar(stat="identity") +
coord_flip() +
xlab("Province Name") +
ylab("Patient Number") +
ggtitle(label = "Patient Number in Each Province")
